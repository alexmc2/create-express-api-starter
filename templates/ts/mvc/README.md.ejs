# <%= projectName %>

Express API starter generated by `@alexmc2/create-express-api-starter`.

## Selected options

- Language: <%= languageLabel %>
- Architecture: <%= architectureLabel %>
- Database: <%= databaseLabel %>
- Educational comments: <%= educationalLabel %>

## Folder structure

```
.
├── src
│   ├── app.ts
│   ├── server.ts
│   ├── routes
│   │   ├── health.ts
│   │   └── users.ts
│   ├── controllers
│   │   └── usersController.ts
│   ├── services
│   │   └── usersService.ts
│   ├── repositories
│   │   └── usersRepository.ts
<% if (isPostgres) { %>│   ├── db
│   │   └── pool.ts
<% } %>│   └── middleware
│       ├── errorHandler.ts
│       └── notFound.ts
├── __tests__
│   └── app.test.ts
<% if (isPostgres) { %>├── db
│   ├── schema.sql
│   └── seed.sql
<% } %><% if (isDocker) { %>├── scripts
│   ├── dbSetup.js
│   ├── dbSeed.js
│   └── dbReset.js
├── compose.yaml
<% } %>├── .env.example
├── .gitignore
├── package.json
├── tsconfig.json
└── jest.config.js
```

## Run the app

1. `npm install`
2. Copy `.env.example` to `.env`
<% if (isPsql) { %>3. Make sure Postgres is running and `DATABASE_URL` is valid.
4. `npm run db:setup`
5. `npm run db:seed`
6. `npm run dev`
<% } else if (isDocker) { %>3. `npm run db:up`
4. `npm run db:setup`
5. `npm run db:seed`
6. `npm run dev`
<% } else { %>3. `npm run dev`
<% } %>

## Add a new route

1. Add a router in `src/routes`.
2. Call controller functions from that route.
3. Put business rules in `src/services`.
4. Put data access code in `src/repositories`.
5. Register the route in `src/app.ts`.

## Where business logic goes

Use `src/services` for business logic. Controllers translate HTTP requests/responses, and repositories handle persistence.

## How errors work

- `src/middleware/notFound.ts` handles unknown routes with a 404 JSON response.
- `src/middleware/errorHandler.ts` returns `{ status, message }` and includes `stack` only in development.

<% if (isPsql) { %>## Database mode: Postgres (psql)

Prerequisites:

- PostgreSQL installed locally
- `psql` available on your `PATH`

Useful commands:

- `npm run db:setup`
- `npm run db:seed`
- `npm run db:reset`
<% } %>
<% if (isDocker) { %>## Database mode: Postgres (Docker)

Docker workflow:

1. `docker compose up -d` (or `npm run db:up`)
2. `npm run db:setup`
3. `npm run db:seed`
4. `npm run dev`

When finished:

- `npm run db:down`
<% } %>
