# <%= projectName %>

Express API starter generated by `@alexmc2/create-express-api-starter`.

## Selected options

- Language: <%= languageLabel %>
- Architecture: <%= architectureLabel %>
- Database: <%= databaseLabel %>
- Educational comments: <%= educationalLabel %>

## Folder structure

```
.
├── src
│   ├── app.js
│   ├── server.js
│   ├── routes
│   │   ├── health.js
│   │   └── users.js
│   ├── controllers
│   │   └── usersController.js
│   ├── services
│   │   └── usersService.js
│   ├── repositories
│   │   └── usersRepository.js
<% if (isPostgres) { %>│   ├── db
│   │   └── pool.js
<% } %>│   ├── errors
│   │   └── AppError.js
│   └── middleware
│       ├── errorHandler.js
│       └── notFound.js
├── __tests__
│   └── app.test.js
<% if (isPostgres) { %>├── db
│   ├── schema.sql
│   └── seed.sql
<% } %><% if (isPostgres) { %>├── scripts
<% if (isPsql) { %>│   ├── dbCreate.js
<% } %>│   ├── dbSetup.js
│   ├── dbSeed.js
│   └── dbReset.js
<% } %><% if (isDocker) { %>├── compose.yaml
<% } %>├── .env.example
├── .gitignore
├── package.json
└── jest.config.js
```

## Run the app

1. `npm install`
2. Copy `.env.example` to `.env`
<% if (isPsql) { %>3. Make sure Postgres is running and `DATABASE_URL` is valid.
4. `npm run db:create` (creates the database if it doesn't exist)
5. `npm run db:setup`
6. `npm run db:seed`
7. `npm run dev`
<% } else if (isDocker) { %>3. `npm run db:up`
4. `npm run db:setup`
5. `npm run db:seed`
6. `npm run dev`
<% } else { %>3. `npm run dev`
<% } %>

## Add a new route

1. Create a router file in `src/routes`.
2. Add a controller function in `src/controllers`.
3. Add business logic in `src/services`.
4. Register the route in `src/app.js`.

## Where business logic goes

Put business rules in `src/services`. Controllers focus on HTTP concerns, and repositories only handle data access.

## How errors work

- `src/middleware/notFound.js` handles unknown routes with a 404 JSON response.
- `src/middleware/errorHandler.js` returns `{ status, message }` and includes `stack` only in development.

<% if (isPsql) { %>## Database mode: Postgres (psql)

Prerequisites:

- PostgreSQL installed locally
- `psql` available on your `PATH`

Useful commands:

- `npm run db:create` — create the database (safe to run if it already exists)
- `npm run db:setup` — apply the schema
- `npm run db:seed` — insert sample data
- `npm run db:reset` — re-apply schema and seed data

### Troubleshooting

**"connection refused"** — PostgreSQL isn't running. Start it with `sudo systemctl start postgresql` (Linux), `brew services start postgresql` (macOS), or check Services (Windows).

**"role does not exist"** — Your OS user doesn't have a matching Postgres role. Run `sudo -u postgres createuser --superuser $USER` to create one.

**"database does not exist"** — Run `npm run db:create` to create the database automatically.
<% } %>
<% if (isDocker) { %>## Database mode: Postgres (Docker)

Docker workflow:

1. `docker compose up -d` (or `npm run db:up`)
2. `npm run db:setup`
3. `npm run db:seed`
4. `npm run dev`

When finished:

- `npm run db:down`
<% } %>
